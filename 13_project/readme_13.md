Для построения системы рекомендаций фильмов воспользуемся данными TMDB 5000 Movie Dataset.

Датасет tmdb_5000_credits.csv содержит следующие данные:

movie_id — id каждого фильма
cast — имена главных и второстепенных актеров
crew — имена режиссера, редактора, композитора, сценариста и т. д.

Датасет tmdb_5000_movies.csv содержит следующие данные:

id — id каждого фильма
budget — бюджет фильма
genre — жанр фильма: (боевик, комедия, триллер и т.д.)
homepage — ссылка на домашнюю страницу фильма
keywords — ключевые слова или теги, относящиеся к фильму
original_language — язык фильма
original_title — оригинальное название
overview — описание сюжета
popularity — популярность
production_companies — киностудия
production_countries — страна выпуска
release_date — дата выпуска
revenue — мировой доход
runtime — время фильма в минутах
status — статус фильма
tagline — слоган
title — название
vote_average — средняя оценка
vote_count — количество голосов

Task 1
Объедини общие данные о фильмах tmdb_5000_movies и каст фильмов tmdb_5000_credits. Оставь в датасете только фильмы, которые вышли в "релиз".
Выведи количество фильмов, оставшихся после фильтрации.

Task 2
Самый наивный подход к рекомендации фильмов - рекомендовать фильмы с лучшими оценками пользователей. Фильмы, которые пользуются большей популярностью и признанием критиков, с большей вероятностью понравятся среднему зрителю. Для этого составим топ популярных фильмов, которые будем рекомендовать пользователям.

Для справедливой оценки фильмов возьмем текущую рейтинговую систему IMDB (weighted rating (WR)). Имплементируй функцию weighted_rating. С её помощью рассчитай рейтинг для каждого фильма и сохрани его в колонку simple_score.
Выведи топ-5 фильмов по получившемуся рейтингу.

В качестве параметра 
m
 выбери 95-й квантиль количества голосов.

Task 3
Такой подход к рекомендациям очень наивен, так как не учитывает информацию о самом фильме (жанр, режиссер, описание, актеры и т.п).
Content Based Filtering (Фильтрация на основе содержания) - тип рекомендательной системы, которая предлагает пользователям похожие элементы на основе конкретного элемента. Общая идея этих рекомендательных систем заключается в том, что если человеку понравился определенный товар, то ему понравится и похожий на него товар.

“”
Реализуем алгоритм рекомендации на основе описания фильма. Для это требуется провести предобработку текста:

Замени NaN в описании фильма на пустой символ ''
Удали все английские стоп-слова (используй параметр stop_words в TfidfVectorizer)
Расcчитай Tf-Idf для описания фильма
Выведи размер получившейся матрицы Tf-Idf

Для TfidfVectorizer используй параметры по умолчанию

Task 4
Теперь тебе необходимо вычислить показатель сходства между описаниями фильмов. Используем косинусное расстояние. Но поскольку мы использовали векторизатор TF-IDF на предыдущем шаге, достаточно вычислить скалярное произведение, которое и даст оценку косинусного сходства. Рассчитать его можно через linear_kernel. Результат сохрани в переменную cosine_sim.

Выведи размер получившейся матрицы cosine_sim.

Task 5
Напиши функцию get_recommendations. На вход она принимает:

movies_dataset - датасет фильмов
title - название фильма, для которого мы будем искать похожие
cosine_sim - матрица расстояний между описаниями
top_k - топ-k cхожих фильмов
Возвращает top_k названий фильмов, описание которых похоже на выбранный фильм.
Выведи топ-5 фильмов для title='Saving Private Ryan' и их описания.

Task 6
Еще один подход к построению рекомендательной системы - подход на основе сходства между пользователями. Этот подход называется Collaborative Filtering (Коллаборативная фильтрация).

“”
Коллаборативная фильтрация - это тип рекомендательной системы, которая использует поведение и предпочтения похожих пользователей для рекомендации товаров или продуктов конкретному пользователю. Система собирает данные о прошлом поведении пользователей, такие как покупки, рейтинги и отзывы, и анализирует их для выявления закономерностей и сходства между пользователями. На основе этих закономерностей система рекомендует товары, которые понравились или были приобретены другими такими же пользователями в прошлом.

Для реализации Коллаборативной фильтрации нам потребуются оценки пользователей ratings.

userId - id пользователя
movieId - id фильма
rating - оценка фильма (от 0 до 5)
timestamp - время оценки

Воспользуйся библиотекой surprise для обучения модели оценки рейтинга фильма SVD.
Выведи средние значения 'RMSE', 'MAE' на кросс-валидации с параметрами cv=5.
